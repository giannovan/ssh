{"name":"centos6.sh","tagline":"","body":"#!/bin/bash\r\n\r\n# initialisasi var\r\nOS=`uname -p`;\r\n\r\n# go to root\r\ncd\r\n\r\n# set locale\r\nsed -i 's/AcceptEnv/#AcceptEnv/g' /etc/ssh/sshd_config\r\nservice sshd restart\r\n\r\n# disable ipv6\r\necho 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6\r\nsed -i '$ i\\echo 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6' /etc/rc.local\r\nsed -i '$ i\\echo 1 > /proc/sys/net/ipv6/conf/all/disable_ipv6' /etc/rc.d/rc.local\r\n\r\n# install wget and curl\r\nyum -y install wget curl\r\n\r\n# setting repo\r\nwget http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm\r\nwget http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\r\nrpm -Uvh epel-release-6-8.noarch.rpm\r\nrpm -Uvh remi-release-6.rpm\r\n\r\nif [ \"$OS\" == \"x86_64\" ]; then\r\n  wget http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el6.rf.x86_64.rpm\r\n  rpm -Uvh rpmforge-release-0.5.3-1.el6.rf.x86_64.rpm\r\nelse\r\n  wget http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.3-1.el6.rf.i686.rpm\r\n  rpm -Uvh rpmforge-release-0.5.3-1.el6.rf.i686.rpm\r\nfi\r\n\r\nsed -i 's/enabled = 1/enabled = 0/g' /etc/yum.repos.d/rpmforge.repo\r\nsed -i -e \"/^\\[remi\\]/,/^\\[.*\\]/ s|^\\(enabled[ \\t]*=[ \\t]*0\\\\)|enabled=1|\" /etc/yum.repos.d/remi.repo\r\nrm -f *.rpm\r\n\r\n# remove unused\r\nyum -y remove sendmail;\r\nyum -y remove httpd;\r\nyum -y remove cyrus-sasl\r\n\r\n# update\r\nyum -y update\r\n\r\n# install webserver\r\nyum -y install nginx php-fpm php-cli\r\nservice nginx restart\r\nservice php-fpm restart\r\nchkconfig nginx on\r\nchkconfig php-fpm on\r\n\r\n# install essential package\r\nyum -y install screen iftop htop nmap bc nethogs openvpn vnstat ngrep mtr git zsh mrtg unrar rsyslog rkhunter mrtg net-snmp net-snmp-utils expect nano bind-utils\r\nyum -y groupinstall 'Development Tools'\r\nyum -y install cmake\r\n\r\nyum -y --enablerepo=rpmforge install axel sslh ptunnel unrar\r\n\r\n# matiin exim\r\nservice exim stop\r\nchkconfig exim off\r\n\r\n# setting vnstat\r\nvnstat -u -i venet0\r\necho \"MAILTO=root\" > /etc/cron.d/vnstat\r\necho \"*/5 * * * * root /usr/sbin/vnstat.cron\" >> /etc/cron.d/vnstat\r\nsed -i 's/eth0/venet0/g' /etc/sysconfig/vnstat\r\nservice vnstat restart\r\nchkconfig vnstat on\r\n\r\n# install screenfetch\r\ncd\r\nwget https://github.com/KittyKatt/screenFetch/raw/master/screenfetch-dev\r\nmv screenfetch-dev /usr/bin/screenfetch\r\nchmod +x /usr/bin/screenfetch\r\necho \"clear\" >> .bash_profile\r\necho \"screenfetch\" >> .bash_profile\r\n\r\n# install webserver\r\ncd\r\nwget -O /etc/nginx/nginx.conf \"https://raw.github.com/arieonline/autoscript/master/conf/nginx.conf\"\r\nsed -i 's/www-data/nginx/g' /etc/nginx/nginx.conf\r\nmkdir -p /home/vps/public_html\r\necho \"<pre>Setup by KangArie | JualSSH.com | @arieonline | 7946F434</pre>\" > /home/vps/public_html/index.html\r\necho \"<?php phpinfo(); ?>\" > /home/vps/public_html/info.php\r\nrm /etc/nginx/conf.d/*\r\nwget -O /etc/nginx/conf.d/vps.conf \"https://raw.github.com/arieonline/autoscript/master/conf/vps.conf\"\r\nsed -i 's/apache/nginx/g' /etc/php-fpm.d/www.conf\r\nchmod -R +rx /home/vps\r\nservice php-fpm restart\r\nservice nginx restart\r\n\r\n# install openvpn\r\nwget -O /etc/openvpn/openvpn.tar \"https://raw.github.com/arieonline/autoscript/master/conf/openvpn-debian.tar\"\r\ncd /etc/openvpn/\r\ntar xf openvpn.tar\r\nwget -O /etc/openvpn/1194.conf \"https://raw.github.com/arieonline/autoscript/master/conf/1194-centos.conf\"\r\nif [ \"$OS\" == \"x86_64\" ]; then\r\n  wget -O /etc/openvpn/1194.conf \"https://raw.github.com/arieonline/autoscript/master/conf/1194-centos64.conf\"\r\nfi\r\nwget -O /etc/iptables.up.rules \"https://raw.github.com/arieonline/autoscript/master/conf/iptables.up.rules\"\r\nsed -i '$ i\\iptables-restore < /etc/iptables.up.rules' /etc/rc.local\r\nsed -i '$ i\\iptables-restore < /etc/iptables.up.rules' /etc/rc.d/rc.local\r\nMYIP=`curl -s ifconfig.me`;\r\nMYIP2=\"s/xxxxxxxxx/$MYIP/g\";\r\nsed -i $MYIP2 /etc/iptables.up.rules;\r\niptables-restore < /etc/iptables.up.rules\r\nsysctl -w net.ipv4.ip_forward=1\r\nsed -i 's/net.ipv4.ip_forward = 0/net.ipv4.ip_forward = 1/g' /etc/sysctl.conf\r\nservice openvpn restart\r\nchkconfig openvpn on\r\ncd\r\n\r\n# configure openvpn client config\r\ncd /etc/openvpn/\r\nwget -O /etc/openvpn/1194-client.ovpn \"https://raw.github.com/arieonline/autoscript/master/conf/1194-client.conf\"\r\nsed -i $MYIP2 /etc/openvpn/1194-client.ovpn;\r\nPASS=`cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 15 | head -n 1`;\r\nuseradd -M -s /bin/false KangArie\r\necho \"KangArie:$PASS\" | chpasswd\r\necho \"KangArie\" > pass.txt\r\necho \"$PASS\" >> pass.txt\r\ntar cf client.tar 1194-client.ovpn pass.txt\r\ncp client.tar /home/vps/public_html/\r\ncd\r\n\r\n# install badvpn\r\nwget -O /usr/bin/badvpn-udpgw \"https://raw.github.com/arieonline/autoscript/master/conf/badvpn-udpgw\"\r\nif [ \"$OS\" == \"x86_64\" ]; then\r\n  wget -O /usr/bin/badvpn-udpgw \"https://raw.github.com/arieonline/autoscript/master/conf/badvpn-udpgw64\"\r\nfi\r\nsed -i '$ i\\screen -AmdS badvpn badvpn-udpgw --listen-addr 127.0.0.1:7300' /etc/rc.local\r\nsed -i '$ i\\screen -AmdS badvpn badvpn-udpgw --listen-addr 127.0.0.1:7300' /etc/rc.d/rc.local\r\nchmod +x /usr/bin/badvpn-udpgw\r\nscreen -AmdS badvpn badvpn-udpgw --listen-addr 127.0.0.1:7300\r\n\r\n# install mrtg\r\ncd /etc/snmp/\r\nwget -O /etc/snmp/snmpd.conf \"https://raw.github.com/arieonline/autoscript/master/conf/snmpd.conf\"\r\nwget -O /root/mrtg-mem.sh \"https://raw.github.com/arieonline/autoscript/master/conf/mrtg-mem.sh\"\r\nchmod +x /root/mrtg-mem.sh\r\nservice snmpd restart\r\nchkconfig snmpd on\r\nsnmpwalk -v 1 -c public localhost | tail\r\nmkdir -p /home/vps/public_html/mrtg\r\ncfgmaker --zero-speed 100000000 --global 'WorkDir: /home/vps/public_html/mrtg' --output /etc/mrtg/mrtg.cfg public@localhost\r\ncurl \"https://raw.github.com/arieonline/autoscript/master/conf/mrtg.conf\" >> /etc/mrtg/mrtg.cfg\r\nsed -i 's/WorkDir: \\/var\\/www\\/mrtg/# WorkDir: \\/var\\/www\\/mrtg/g' /etc/mrtg/mrtg.cfg\r\nsed -i 's/# Options\\[_\\]: growright, bits/Options\\[_\\]: growright/g' /etc/mrtg/mrtg.cfg\r\nindexmaker --output=/home/vps/public_html/mrtg/index.html /etc/mrtg/mrtg.cfg\r\necho \"0-59/5 * * * * root env LANG=C /usr/bin/mrtg /etc/mrtg/mrtg.cfg\" > /etc/cron.d/mrtg\r\nLANG=C /usr/bin/mrtg /etc/mrtg/mrtg.cfg\r\nLANG=C /usr/bin/mrtg /etc/mrtg/mrtg.cfg\r\nLANG=C /usr/bin/mrtg /etc/mrtg/mrtg.cfg\r\ncd\r\n\r\n# setting port ssh\r\nsed -i '/Port 22/a Port 143' /etc/ssh/sshd_config\r\nsed -i 's/#Port 22/Port  22/g' /etc/ssh/sshd_config\r\nservice sshd restart\r\nchkconfig sshd on\r\n\r\n# install dropbear\r\nyum -y install dropbear\r\necho \"OPTIONS=\\\"-p 109 -p 110 -p 443\\\"\" > /etc/sysconfig/dropbear\r\necho \"/bin/false\" >> /etc/shells\r\nservice dropbear restart\r\nchkconfig dropbear on\r\n\r\n# install vnstat gui\r\ncd /home/vps/public_html/\r\nwget http://www.sqweek.com/sqweek/files/vnstat_php_frontend-1.5.1.tar.gz\r\ntar xf vnstat_php_frontend-1.5.1.tar.gz\r\nrm vnstat_php_frontend-1.5.1.tar.gz\r\nmv vnstat_php_frontend-1.5.1 vnstat\r\ncd vnstat\r\nsed -i 's/eth0/venet0/g' config.php\r\nsed -i \"s/\\$iface_list = array('venet0', 'sixxs');/\\$iface_list = array('venet0');/g\" config.php\r\nsed -i \"s/\\$language = 'nl';/\\$language = 'en';/g\" config.php\r\nsed -i 's/Internal/Internet/g' config.php\r\nsed -i '/SixXS IPv6/d' config.php\r\ncd\r\n\r\n# install fail2ban\r\nyum -y install fail2ban\r\nservice fail2ban restart\r\nchkconfig fail2ban on\r\n\r\n# install squid\r\nyum -y install squid\r\nwget -O /etc/squid/squid.conf \"https://raw.github.com/arieonline/autoscript/master/conf/squid-centos.conf\"\r\nsed -i $MYIP2 /etc/squid/squid.conf;\r\nservice squid restart\r\nchkconfig squid on\r\n\r\n# install webmin\r\ncd\r\nwget http://prdownloads.sourceforge.net/webadmin/webmin-1.670-1.noarch.rpm\r\nrpm -i webmin-1.670-1.noarch.rpm;\r\nrm webmin-1.670-1.noarch.rpm\r\nservice webmin restart\r\nchkconfig webmin on\r\n\r\n# downlaod script\r\ncd\r\nwget -O speedtest_cli.py \"https://raw.github.com/sivel/speedtest-cli/master/speedtest_cli.py\"\r\nwget -O bench-network.sh \"https://raw.github.com/arieonline/autoscript/master/conf/bench-network.sh\"\r\nwget -O ps_mem.py \"https://raw.github.com/pixelb/ps_mem/master/ps_mem.py\"\r\nwget -O limit.sh \"https://raw.github.com/arieonline/autoscript/master/conf/limit.sh\"\r\ncurl http://script.jualssh.com/user-login.sh > user-login.sh\r\ncurl http://script.jualssh.com/user-expire.sh > user-expire.sh\r\ncurl http://script.jualssh.com/user-limit.sh > user-limit.sh\r\necho \"0 0 * * * root /root/user-expire.sh\" > /etc/cron.d/user-expire\r\nsed -i '$ i\\screen -AmdS limit /root/limit.sh' /etc/rc.local\r\nsed -i '$ i\\screen -AmdS limit /root/limit.sh' /etc/rc.d/rc.local\r\nchmod +x bench-network.sh\r\nchmod +x speedtest_cli.py\r\nchmod +x ps_mem.py\r\nchmod +x user-login.sh\r\nchmod +x user-expire.sh\r\nchmod +x user-limit.sh\r\nchmod +x limit.sh\r\n\r\n# cron\r\nservice crond start\r\nchkconfig crond on\r\n\r\n# set time GMT +7\r\nln -fs /usr/share/zoneinfo/Asia/Jakarta /etc/localtime\r\n\r\n# finalisasi\r\nchown -R nginx:nginx /home/vps/public_html\r\nservice nginx start\r\nservice php-fpm start\r\nservice vnstat restart\r\nservice openvpn restart\r\nservice snmpd restart\r\nservice sshd restart\r\nservice dropbear restart\r\nservice fail2ban restart\r\nservice squid restart\r\nservice webmin restart\r\nservice crond start\r\nchkconfig crond on\r\n\r\n# info\r\nclear\r\necho \"JualSSH.com | @arieonline | KangArie | 7946F434\" | tee log-install.txt\r\necho \"===============================================\" | tee -a log-install.txt\r\necho \"\"  | tee -a log-install.txt\r\necho \"Service\"  | tee -a log-install.txt\r\necho \"-------\"  | tee -a log-install.txt\r\necho \"OpenVPN  : TCP 1194 (client config : http://$MYIP/client.tar)\"  | tee -a log-install.txt\r\necho \"OpenSSH  : 22, 143\"  | tee -a log-install.txt\r\necho \"Dropbear : 109, 110, 443\"  | tee -a log-install.txt\r\necho \"Squid3   : 8080 (limit to IP SSH)\"  | tee -a log-install.txt\r\necho \"badvpn   : badvpn-udpgw port 7300\"  | tee -a log-install.txt\r\necho \"\"  | tee -a log-install.txt\r\necho \"Script\"  | tee -a log-install.txt\r\necho \"------\"  | tee -a log-install.txt\r\necho \"screenfetch\"  | tee -a log-install.txt\r\necho \"./ps_mem.py\"  | tee -a log-install.txt\r\necho \"./speedtest_cli.py --share\"  | tee -a log-install.txt\r\necho \"./bench-network.sh\"  | tee -a log-install.txt\r\necho \"./user-login.sh\"  | tee -a log-install.txt\r\necho \"./user-expire.sh\"  | tee -a log-install.txt\r\necho \"./user-limit.sh 2\"  | tee -a log-install.txt\r\necho \"\"  | tee -a log-install.txt\r\necho \"Account Default (utk SSH dan VPN)\"  | tee -a log-install.txt\r\necho \"---------------\"  | tee -a log-install.txt\r\necho \"User     : KangArie\"  | tee -a log-install.txt\r\necho \"Password : $PASS\"  | tee -a log-install.txt\r\necho \"\"  | tee -a log-install.txt\r\necho \"Fitur lain\"  | tee -a log-install.txt\r\necho \"----------\"  | tee -a log-install.txt\r\necho \"Webmin   : http://$MYIP:10000/\"  | tee -a log-install.txt\r\necho \"vnstat   : http://$MYIP/vnstat/\"  | tee -a log-install.txt\r\necho \"MRTG     : http://$MYIP/mrtg/\"  | tee -a log-install.txt\r\necho \"Timezone : Asia/Jakarta\"  | tee -a log-install.txt\r\necho \"Fail2Ban : [on]\"  | tee -a log-install.txt\r\necho \"IPv6     : [off]\"  | tee -a log-install.txt\r\necho \"\"  | tee -a log-install.txt\r\necho \"Log Installasi --> /root/log-install.txt\"  | tee -a log-install.txt\r\necho \"\"  | tee -a log-install.txt\r\necho \"SILAHKAN REBOOT VPS ANDA !\"  | tee -a log-install.txt\r\necho \"\"  | tee -a log-install.txt\r\necho \"===============================================\"  | tee -a log-install.txt","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}